#!/bin/bash

# API Request Automation Script
# Fetches Pikachu data from PokÃ©mon API and saves to data.json
# Logs errors to errors.txt if request fails

API_URL="https://pokeapi.co/api/v2/pokemon/pikachu"
OUTPUT_FILE="data.json"
ERROR_FILE="errors.txt"

# Make API request and save response
response=$(curl -s -w "\n%{http_code}" "$API_URL")
http_code=$(echo "$response" | tail -n1)
body=$(echo "$response" | sed '$d')

# Check if request was successful (HTTP 200)
if [ "$http_code" -eq 200 ]; then
    # Save successful response to data.json
    echo "$body" > "$OUTPUT_FILE"
    echo "Successfully fetched Pikachu data and saved to $OUTPUT_FILE"
else
    # Log error to errors.txt
    echo "Error: HTTP $http_code - Failed to fetch data from $API_URL" > "$ERROR_FILE"
    echo "Response body: $body" >> "$ERROR_FILE"
    echo "Failed to fetch Pikachu data. Error logged to $ERROR_FILE"
    exit 1
fi

